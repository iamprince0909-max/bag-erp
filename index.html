<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Bag ERP</title>

<style>
body{
font-family:Segoe UI;
margin:0;
background:#0f172a;
color:white;
}

header{
padding:15px 30px;
background:#020617;
font-size:22px;
font-weight:bold;
}

.container{
display:flex;
height:calc(100vh - 60px);
}

.sidebar{
width:220px;
background:#111827;
padding:20px;
}

.sidebar button{
width:100%;
padding:14px;
margin-bottom:10px;
border:none;
border-radius:8px;
cursor:pointer;
background:#1f2937;
color:white;
}

.sidebar button.active{
background:#3b82f6;
}

.main{
flex:1;
padding:20px;
overflow:auto;
}

table{
width:100%;
border-collapse:collapse;
margin-top:15px;
}

td,th{
border:1px solid #374151;
padding:8px;
text-align:center;
}

input{
width:100%;
background:#111827;
border:none;
color:white;
padding:6px;
}

button.small{
padding:6px 10px;
background:#ef4444;
border:none;
color:white;
border-radius:5px;
cursor:pointer;
}

.add-btn{
margin-top:10px;
padding:10px;
background:#22c55e;
border:none;
color:white;
border-radius:6px;
cursor:pointer;
}

.card{
background:#1f2937;
padding:20px;
border-radius:12px;
margin-top:20px;
}
</style>
</head>

<body>

<header>Bag ERP System</header>

<div class="container">

<div class="sidebar">
<button onclick="showPage('spec',this)" class="active">Spec Sheet</button>
<button onclick="showPage('cutting',this)">Cutting Calculator</button>
<button onclick="showPage('material',this)">Material Summary</button>
</div>

<div class="main" id="content"></div>

</div>

<script>

let specData = JSON.parse(localStorage.getItem("specData")) || [];

function saveData(){
localStorage.setItem("specData",JSON.stringify(specData));
}

function showPage(page,btn){
document.querySelectorAll(".sidebar button").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");

if(page==="spec") loadSpec();
if(page==="cutting") loadCutting();
if(page==="material") loadMaterial();
}

function loadSpec(){
let html=`<h2>Spec Sheet Editor</h2>

<table>
<tr>
<th>Part</th>
<th>Material</th>
<th>Qty</th>
<th>Delete</th>
</tr>`;

specData.forEach((row,i)=>{
html+=`
<tr>
<td><input value="${row.part}" onchange="updateRow(${i},'part',this.value)"></td>
<td><input value="${row.mat}" onchange="updateRow(${i},'mat',this.value)"></td>
<td><input type="number" value="${row.qty}" onchange="updateRow(${i},'qty',this.value)"></td>
<td><button class="small" onclick="deleteRow(${i})">X</button></td>
</tr>`;
});

html+=`</table>
<button class="add-btn" onclick="addRow()">+ Add Row</button>`;

document.getElementById("content").innerHTML=html;
}

function addRow(){
specData.push({part:"",mat:"",qty:0});
saveData();
loadSpec();
}

function deleteRow(i){
specData.splice(i,1);
saveData();
loadSpec();
}

function updateRow(i,key,val){
specData[i][key]=val;
saveData();
}

function loadCutting(){
let total=specData.reduce((sum,r)=>sum+Number(r.qty||0),0);

document.getElementById("content").innerHTML=`
<h2>Cutting Calculator</h2>
<div class="card">
Total Pieces Needed:
<h1>${total}</h1>
</div>`;
}

function loadMaterial(){
let matSummary={};

specData.forEach(r=>{
if(!matSummary[r.mat]) matSummary[r.mat]=0;
matSummary[r.mat]+=Number(r.qty||0);
});

let html=`<h2>Material Summary</h2><div class="card">`;

for(let m in matSummary){
html+=`<p>${m} : <b>${matSummary[m]}</b></p>`;
}

html+=`</div>`;
document.getElementById("content").innerHTML=html;
}

showPage("spec",document.querySelector(".sidebar button"));

</script>

</body>
</html>
