<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Spec ERP</title>

<style>
body{
font-family:Segoe UI;
margin:0;
background:#f3f4f6;
}

header{
background:#111827;
color:white;
padding:15px;
font-size:22px;
}

.container{
padding:20px;
}

.topbar{
display:flex;
gap:10px;
margin-bottom:15px;
}

input,button{
padding:8px;
font-size:14px;
}

button{
cursor:pointer;
border:none;
background:#2563eb;
color:white;
border-radius:4px;
}

table{
width:100%;
border-collapse:collapse;
background:white;
}

td,th{
border:1px solid #444;
padding:8px;
text-align:center;
}

th{
background:#e5e7eb;
}

.section-title{
text-align:center;
font-size:22px;
margin:15px 0;
font-weight:bold;
}

.delete-btn{
background:#ef4444;
}

.header-table td{
font-weight:bold;
}

.search{
margin-left:auto;
}
</style>
</head>

<body>

<header>SPEC & MATERIAL DETAILS</header>

<div class="container">

<div class="topbar">

<input id="styleName" placeholder="Style Name">

<button onclick="saveStyle()">Save Style</button>

<select id="styleList" onchange="loadStyle()">
<option value="">Load Style</option>
</select>

<input id="search" class="search" placeholder="Search Style" oninput="searchStyle()">

</div>

<table class="header-table">
<tr>
<td>Brand</td>
<td><input id="brand"></td>
<td>Finish</td>
<td><input id="finish"></td>
</tr>
<tr>
<td>Remarks</td>
<td colspan="3"><input id="remarks"></td>
</tr>
</table>

<div class="section-title">Material BOM</div>

<table id="bom">
<tr>
<th>S.No</th>
<th>Material</th>
<th>Description</th>
<th>Qty/Bag</th>
<th>Unit</th>
<th>Delete</th>
</tr>
</table>

<button onclick="addRow()">+ Add Row</button>

</div>

<script>

let db = JSON.parse(localStorage.getItem("styles")) || {};

function refreshStyleList(){
let list=document.getElementById("styleList");
list.innerHTML='<option value="">Load Style</option>';
for(let k in db){
list.innerHTML+=`<option>${k}</option>`;
}
}
refreshStyleList();

function addRow(data={}){
let table=document.getElementById("bom");
let i=table.rows.length;

let row=table.insertRow();

row.innerHTML=`
<td>${i}</td>
<td><input value="${data.mat||""}"></td>
<td><input value="${data.desc||""}"></td>
<td><input type="number" value="${data.qty||""}"></td>
<td><input value="${data.unit||""}"></td>
<td><button class="delete-btn" onclick="deleteRow(this)">X</button></td>
`;
}

function deleteRow(btn){
btn.parentElement.parentElement.remove();
reindex();
}

function reindex(){
let rows=document.querySelectorAll("#bom tr");
rows.forEach((r,i)=>{
if(i>0) r.cells[0].innerText=i;
});
}

function saveStyle(){

let name=document.getElementById("styleName").value;
if(!name) return alert("Enter style name");

let rows=document.querySelectorAll("#bom tr");
let bom=[];

rows.forEach((r,i)=>{
if(i===0) return;
let cells=r.querySelectorAll("input");
bom.push({
mat:cells[0].value,
desc:cells[1].value,
qty:cells[2].value,
unit:cells[3].value
});
});

db[name]={
brand:brand.value,
finish:finish.value,
remarks:remarks.value,
bom
};

localStorage.setItem("styles",JSON.stringify(db));
refreshStyleList();
alert("Saved!");
}

function loadStyle(){
let name=styleList.value;
if(!db[name]) return;

let d=db[name];

brand.value=d.brand;
finish.value=d.finish;
remarks.value=d.remarks;

document.getElementById("bom").innerHTML=`
<tr>
<th>S.No</th>
<th>Material</th>
<th>Description</th>
<th>Qty/Bag</th>
<th>Unit</th>
<th>Delete</th>
</tr>
`;

d.bom.forEach(addRow);
}

function searchStyle(){
let q=search.value.toLowerCase();
let list=document.getElementById("styleList");
for(let o of list.options){
o.hidden=!o.text.toLowerCase().includes(q) && o.value;
}
}

addRow();

</script>

</body>
</html>
